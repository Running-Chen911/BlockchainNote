[TOC]

## P2P通信协议
- DHT(Distributed Hash Table)
- Gossip Protocol

### DHT
- 用于传统的P2P网络中。例如BT网络。
- 网络中，每个节点并不保存所有的数据。

### Gossip Protocol
- 用于区块链网络中
- 网络中
    - 每个节点保存全量的数据。
    - 每个节点从peer拉取数据达到和peer数据一致。
    - 每个节点收到或产生新数据的时候，会转发给peer，最终经过Multi-hop之后到达全网。

- 优点：
    - 抗单点故障。
    - 抗网络阻隔。

- 问题与解决方案
    1. Multi-hop产生的消息延迟
        - 方式一：增加节点保的Peer数量，减少消息的跳转次数，使消息在更少的跳转次数下进行传递。
        - 方式二：排除恶意的Peer节点，通过打分机制。
    2. 应对网络峰值，并发性引起的问题
        - 方式一：分批有序进行广播；例如先发送给打分机制里获取分数高的节点。
    3. 数据不一致的问题，产生孤块
        - 方式一：通过多轮询问，并以与其中大多数Peer保持一致。（例如Avalance公链网络）
    4. 消息隐私性
        - 方式一：改变消息的起点，消息通过几跳之后才开始广播。（例如Dandelion网络）
        - 方式二：改变消息的终点，消息进入加密池后才广播给其它节点。（例如Nym公链网络）
        - 方式三：改变消息通道。

## 节点间的通信
- 区块链网络中两个节点建立连接，发送握手信息
    1. 区块高度
    2. 创世hash
    3. 最新区块Hash
    4. 网络ID